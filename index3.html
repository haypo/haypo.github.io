<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="generator" content="Pelican" />
        <title>Victor Stinner blog 3</title>
        <link rel="stylesheet" href="https://vstinner.github.io/theme/css/main.css" />
        <link href="https://vstinner.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Victor Stinner blog 3 Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://vstinner.github.io/">Victor Stinner blog 3</a></h1>
                <nav><ul>
                    <li><a href="https://vstinner.github.io/category/benchmark.html">benchmark</a></li>
                    <li><a href="https://vstinner.github.io/category/cpython.html">cpython</a></li>
                    <li><a href="https://vstinner.github.io/category/linux.html">linux</a></li>
                    <li><a href="https://vstinner.github.io/category/python.html">python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

                <section id="content" class="body">
                    <ol id="posts-list" class="hfeed" start="9">
            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/pep-383.html" rel="bookmark"
                           title="Permalink to Python 3.1 surrogateescape error handler (PEP 383)">Python 3.1 surrogateescape error handler (PEP 383)</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-15T18:00:00+01:00">
                Published: jeu. 15 mars 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>In my previous article, I wrote that <tt class="docutils literal">os.listdir(str)</tt> ignored silently
undecodable filenames in Python 3.0 and that lying on the real content of a
directory looks like a very bad idea.</p>
<p><strong>Martin v. Löwis</strong> found a very smart solution to this problem: the
<tt class="docutils literal">surrogateescape</tt> error handler.</p>
<p><strong>This …</strong></p>
                <a class="readmore" href="https://vstinner.github.io/pep-383.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/python30-listdir-undecodable-filenames.html" rel="bookmark"
                           title="Permalink to Python 3.0 listdir() Bug on Undecodable Filenames">Python 3.0 listdir() Bug on Undecodable Filenames</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-09T13:00:00+01:00">
                Published: ven. 09 mars 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>Ten years ago, when Python 3.0 final was released, <tt class="docutils literal">os.listdir(str)</tt>
<strong>ignored silently undecodable filenames</strong>:</p>
<pre class="literal-block">
$ python3.0
&gt;&gt;&gt; os.mkdir(b'x')
&gt;&gt;&gt; open(b'x/nonascii\xff', 'w').close()
&gt;&gt;&gt; os.listdir('x')
[]
</pre>
<p>You had to use bytes to see all filenames:</p>
<pre class="literal-block">
&gt;&gt;&gt; os.listdir(b'x')
[b'nonascii\xff']
</pre>
<p>If the locale is POSIX …</p>
                <a class="readmore" href="https://vstinner.github.io/python30-listdir-undecodable-filenames.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/python37-gil-change.html" rel="bookmark"
                           title="Permalink to How I fixed a very old GIL race condition in Python 3.7">How I fixed a very old GIL race condition in Python 3.7</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-08T10:00:00+01:00">
                Published: jeu. 08 mars 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p><strong>It took me 4 years to fix a nasty bug in the famous Python GIL</strong> (Global
Interpreter Lock), one of the most critical part of Python. I had to dig the
Git history to find a <strong>change made 26 years ago</strong> by <strong>Guido van Rossum</strong>: at
this time, <em>threads were …</em></p>
                <a class="readmore" href="https://vstinner.github.io/python37-gil-change.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/python37-pep-564-nanoseconds.html" rel="bookmark"
                           title="Permalink to Python 3.7 nanoseconds">Python 3.7 nanoseconds</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-06T16:30:00+01:00">
                Published: mar. 06 mars 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>Thanks to my <a class="reference external" href="https://vstinner.github.io/python37-perf-counter-nanoseconds.html">latest change on time.perf_counter()</a>, all Python 3.7 clocks now use
nanoseconds as integer internally. It became possible to propose again my old
idea of getting time as nanoseconds at Python level and so I wrote a new
<a class="reference external" href="http://www.python.org/dev/peps/pep-0564">PEP 564</a> &quot;Add new time functions with nanosecond …</p>
                <a class="readmore" href="https://vstinner.github.io/python37-pep-564-nanoseconds.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/python37-perf-counter-nanoseconds.html" rel="bookmark"
                           title="Permalink to Python 3.7 perf_counter() nanoseconds">Python 3.7 perf_counter() nanoseconds</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-03-06T15:00:00+01:00">
                Published: mar. 06 mars 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>Since 2012, I have been trying to convert all Python clocks to use internally
nanoseconds. The last clock which still used floating point internally was
<tt class="docutils literal">time.perf_counter()</tt>. INADA Naoki's new importtime tool was an opportunity
for me to have a new look on a tricky integer overflow issue.</p>
<div class="section" id="modify-importtime-to-use-time-perf-counter-clock">
<h2>Modify importtime …</h2></div>
                <a class="readmore" href="https://vstinner.github.io/python37-perf-counter-nanoseconds.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/contrib-cpython-2017q3-part3.html" rel="bookmark"
                           title="Permalink to My contributions to CPython during 2017 Q3: Part 3 (funny bugs)">My contributions to CPython during 2017 Q3: Part 3 (funny bugs)</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-10-19T16:00:00+02:00">
                Published: jeu. 19 octobre 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>My contributions to <a class="reference external" href="https://www.python.org/">CPython</a> during 2017 Q3
(july, august, september), Part 3 (funny bugs).</p>
<p>Previous report: <a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q3-part2.html">My contributions to CPython during 2017 Q3: Part 2 (dangling
threads)</a>.</p>
<p>Summary:</p>
<ul class="simple">
<li>FreeBSD bug: minor() device regression</li>
<li>regrtest snowball effect when hunting memory leaks</li>
<li>Bugfixes</li>
<li>Other Changes</li>
</ul>
<div class="section" id="freebsd-bug-minor-device-regression">
<h2>FreeBSD bug: minor() device regression</h2>
<a class="reference external image-reference" href="https://www.freebsd.org/"><img alt="Logo of the FreeBSD project" src="https://vstinner.github.io/images/freebsd.png" /></a>
<p><a class="reference external" href="https://bugs.python.org/issue31044">bpo-31044</a>: The …</p></div>
                <a class="readmore" href="https://vstinner.github.io/contrib-cpython-2017q3-part3.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/contrib-cpython-2017q3-part2.html" rel="bookmark"
                           title="Permalink to My contributions to CPython during 2017 Q3: Part 2 (dangling threads)">My contributions to CPython during 2017 Q3: Part 2 (dangling threads)</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-10-19T15:00:00+02:00">
                Published: jeu. 19 octobre 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>My contributions to <a class="reference external" href="https://www.python.org/">CPython</a> during 2017 Q3
(july, august, september), Part 2: &quot;Dangling threads&quot;.</p>
<p>Previous report: <a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q3-part1.html">My contributions to CPython during 2017 Q3: Part 1</a>.</p>
<p>Next reports:</p>
<ul class="simple">
<li><a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q3-part3.html">My contributions to CPython during 2017 Q3: Part 3 (funny bugs)</a>.</li>
</ul>
<p>Summary:</p>
<ul class="simple">
<li>Bugfixes: Reference cycles</li>
<li>socketserver leaking threads and processes<ul>
<li>test_logging random bug …</li></ul></li></ul>
                <a class="readmore" href="https://vstinner.github.io/contrib-cpython-2017q3-part2.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/contrib-cpython-2017q3-part1.html" rel="bookmark"
                           title="Permalink to My contributions to CPython during 2017 Q3: Part 1">My contributions to CPython during 2017 Q3: Part 1</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-10-18T15:00:00+02:00">
                Published: mer. 18 octobre 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>My contributions to <a class="reference external" href="https://www.python.org/">CPython</a> during 2017 Q3
(july, august, september), Part 1.</p>
<p>Previous report: <a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q2-part1.html">My contributions to CPython during 2017 Q2 (part1)</a>.</p>
<p>Next reports:</p>
<ul class="simple">
<li><a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q3-part2.html">My contributions to CPython during 2017 Q3: Part 2 (dangling
threads)</a>.</li>
<li><a class="reference external" href="https://vstinner.github.io/contrib-cpython-2017q3-part3.html">My contributions to CPython during 2017 Q3: Part 3 (funny bugs)</a>.</li>
</ul>
<p>Summary:</p>
<ul class="simple">
<li>Statistics</li>
<li>Security fixes …</li></ul>
                <a class="readmore" href="https://vstinner.github.io/contrib-cpython-2017q3-part1.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/python-security.html" rel="bookmark"
                           title="Permalink to Python Security">Python Security</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-09-15T22:00:00+02:00">
                Published: ven. 15 septembre 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/security.html">security</a> <a href="https://vstinner.github.io/tag/python.html">python</a> </p>
</footer><!-- /.post-info -->                <p>I am working on the Python security for years, but I never wrote anything about
that. Let's fix this!</p>
<div class="section" id="psrt">
<h2>PSRT</h2>
<p>I am part of the Python Security Response Team (PSRT): I get emails sent to
<a class="reference external" href="mailto:security&#64;python.org">security&#64;python.org</a>. I try to analyze each report to validate that the bug
is …</p></div>
                <a class="readmore" href="https://vstinner.github.io/python-security.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://vstinner.github.io/new-python-c-api.html" rel="bookmark"
                           title="Permalink to A New C API for CPython">A New C API for CPython</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-09-07T18:00:00+02:00">
                Published: jeu. 07 septembre 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://vstinner.github.io/author/victor-stinner.html">Victor Stinner</a>
        </address>
<p>In <a href="https://vstinner.github.io/category/python.html">python</a>.</p>
<p>tags: <a href="https://vstinner.github.io/tag/optimization.html">optimization</a> <a href="https://vstinner.github.io/tag/cpython.html">cpython</a> </p>
</footer><!-- /.post-info -->                <p>I am currently at a CPython sprint 2017 at Facebook. We are discussing my idea
of writing a new C API for CPython hiding implementation details and replacing
macros with function calls.</p>
<img alt="CPython sprint at Facebook, september 2017" src="https://vstinner.github.io/images/cpython_sprint_sept2017.jpg" />
<p>This article tries to explain why the CPython C API needs to <strong>evolve</strong>.</p>
<div class="section" id="c-api-prevents-further-optimizations">
<h2>C API prevents further optimizations …</h2></div>
                <a class="readmore" href="https://vstinner.github.io/new-python-c-api.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
        <a href="https://vstinner.github.io/index.html">&#8647;</a>
        <a href="https://vstinner.github.io/index2.html">&laquo;</a>
    Page 3 / 7
        <a href="https://vstinner.github.io/index4.html">&raquo;</a>
        <a href="https://vstinner.github.io/index7.html">&#8649;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://vstinner.readthedocs.org/">Victor Stinner's Notes</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://vstinner.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/VictorStinner">Follow @VictorStinner on Twitter</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>